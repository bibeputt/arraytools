

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arraytools.create &mdash; arraytools 0.9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> arraytools
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">arraytools... :</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arraytools_mods.html">Modules in arraytools</a></li>
</ul>
<p class="caption"><span class="caption-text">Sphinx...:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Sphinx_documentation.html">How to document Sphinx</a></li>
</ul>
<p class="caption"><span class="caption-text">ReStructuredText...:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../md_tester.html">Documentation tips</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">arraytools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>arraytools.create</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for arraytools.create</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">create</span>
<span class="sd">======</span>

<span class="sd">Script :   create.py</span>

<span class="sd">Author :   Dan_Patterson@carleton.ca</span>

<span class="sd">Modified : 2019-01-15</span>

<span class="sd">Purpose :  Tools for creating arrays of various geometric shapes</span>

<span class="sd">Notes:</span>

<span class="sd">References</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># pylint: disable=C0103  # invalid-name</span>
<span class="c1"># pylint: disable=R0914  # Too many local variables</span>
<span class="c1"># pylint: disable=R1710  # inconsistent-return-statements</span>
<span class="c1"># pylint: disable=W0105  # string statement has no effect</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">ft</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bool&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)),</span>
      <span class="s1">&#39;float_kind&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{: 0.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">}</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">threshold</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="n">ft</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_print_option</span><span class="o">.</span><span class="n">set_display</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>  <span class="c1"># change to a single -</span>

<span class="n">script</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># print this should you need to locate the script</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;convex&#39;</span><span class="p">,</span>
           <span class="s1">&#39;circle&#39;</span><span class="p">,</span>
           <span class="s1">&#39;ellipse&#39;</span><span class="p">,</span>
           <span class="s1">&#39;hex_flat&#39;</span><span class="p">,</span> <span class="s1">&#39;hex_pointy&#39;</span><span class="p">,</span>
           <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
           <span class="s1">&#39;triangle&#39;</span><span class="p">,</span>
           <span class="s1">&#39;pnt_from_dist_bearing&#39;</span><span class="p">,</span>
           <span class="s1">&#39;xy_grid&#39;</span><span class="p">,</span>
           <span class="s1">&#39;transect_lines&#39;</span>
           <span class="p">]</span>
<span class="c1"># ---- convex hull, circle ellipse, hexagons, rectangles, triangle, xy-grid --</span>
<span class="c1">#</span>
<div class="viewcode-block" id="convex"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.convex">[docs]</a><span class="k">def</span> <span class="nf">convex</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the convex hull for given points</span>
<span class="sd">    :Input is a list of 2D points [(x, y), ...]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_cross_</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cross-product for vectors o-a and o-b</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xo</span><span class="p">,</span> <span class="n">yo</span> <span class="o">=</span> <span class="n">o</span>
        <span class="n">xa</span><span class="p">,</span> <span class="n">ya</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">b</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">xa</span> <span class="o">-</span> <span class="n">xo</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">yb</span> <span class="o">-</span> <span class="n">yo</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">ya</span> <span class="o">-</span> <span class="n">yo</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xb</span> <span class="o">-</span> <span class="n">xo</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>  <span class="c1"># Remove duplicates</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">points</span>
    <span class="c1"># Build lower hull</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">_cross_</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">lower</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lower</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="c1"># Build upper hull</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">_cross_</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">upper</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="c1">#print(&quot;lower\n{}\nupper\n{}&quot;.format(lower, upper))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lower</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">upper</span><span class="p">)</span>  <span class="c1"># upper[:-1]) # for open loop</span></div>


<div class="viewcode-block" id="circle"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.circle">[docs]</a><span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Produce a circle/ellipse depending on parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : number</span>
<span class="sd">        Distance from centre</span>
<span class="sd">    theta : number</span>
<span class="sd">        Angle of densification of the shape around 360 degrees</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">180.0</span><span class="o">-</span><span class="n">theta</span><span class="p">,</span> <span class="n">step</span><span class="o">=-</span><span class="n">theta</span><span class="p">))</span>
    <span class="n">x_s</span> <span class="o">=</span> <span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">+</span> <span class="n">xc</span>    <span class="c1"># X values</span>
    <span class="n">y_s</span> <span class="o">=</span> <span class="n">radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">+</span> <span class="n">yc</span>    <span class="c1"># Y values</span>
    <span class="n">pnts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pnts</span></div>


<div class="viewcode-block" id="ellipse"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.ellipse">[docs]</a><span class="k">def</span> <span class="nf">ellipse</span><span class="p">(</span><span class="n">x_radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">y_radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Produce an ellipse depending on parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    radius : number</span>
<span class="sd">        Distance from centre in the X and Y directions</span>
<span class="sd">    theta : number</span>
<span class="sd">        Angle of densification of the shape around 360 degrees</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">180.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">180.0</span><span class="o">-</span><span class="n">theta</span><span class="p">,</span> <span class="n">step</span><span class="o">=-</span><span class="n">theta</span><span class="p">))</span>
    <span class="n">x_s</span> <span class="o">=</span> <span class="n">x_radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">+</span> <span class="n">xc</span>    <span class="c1"># X values</span>
    <span class="n">y_s</span> <span class="o">=</span> <span class="n">y_radius</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">+</span> <span class="n">yc</span>    <span class="c1"># Y values</span>
    <span class="n">pnts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x_s</span><span class="p">,</span> <span class="n">y_s</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pnts</span></div>


<div class="viewcode-block" id="hex_flat"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.hex_flat">[docs]</a><span class="k">def</span> <span class="nf">hex_flat</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate the points for the flat-headed hexagon</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dy_dx : number</span>
<span class="sd">        The radius width, remember this when setting hex spacing</span>
<span class="sd">    dx : number</span>
<span class="sd">        Increment in x direction, +ve moves west to east, left/right</span>
<span class="sd">    dy : number</span>
<span class="sd">        Increment in y direction, -ve moves north to south, top/bottom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">([</span><span class="mf">180.</span><span class="p">,</span> <span class="mf">120.</span><span class="p">,</span> <span class="mf">60.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">60.</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.</span><span class="p">,</span> <span class="o">-</span><span class="mf">180.</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">f_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">f_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>            <span class="c1"># scaled hexagon about 0, 0</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)))</span>  <span class="c1"># array of coordinates</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="mf">1.5</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">hexs</span> <span class="o">=</span> <span class="p">[</span><span class="n">seed</span> <span class="o">+</span> <span class="p">[</span><span class="n">dx</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">dy</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">)]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hexs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>  <span class="c1"># create the other rows</span>
        <span class="n">hexs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">hexs</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">hexs</span></div>


<div class="viewcode-block" id="hex_pointy"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.hex_pointy">[docs]</a><span class="k">def</span> <span class="nf">hex_pointy</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pointy hex angles, convert to sin, cos, zip and send</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dy_dx - number</span>
<span class="sd">        The radius width, remember this when setting hex spacing</span>
<span class="sd">    dx : number</span>
<span class="sd">        Increment in x direction, +ve moves west to east, left/right</span>
<span class="sd">    dy : number</span>
<span class="sd">        Increment in y direction, -ve moves north to south, top/bottom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">([</span><span class="mf">150.</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="o">-</span><span class="mf">150.</span><span class="p">,</span> <span class="mf">150.</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p_rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy</span>      <span class="c1"># scaled hexagon about 0, 0</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)))</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">*</span> <span class="mf">1.5</span>
    <span class="n">hexs</span> <span class="o">=</span> <span class="p">[</span><span class="n">seed</span> <span class="o">+</span> <span class="p">[</span><span class="n">dx</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">)]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hexs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>  <span class="c1"># create the other rows</span>
        <span class="n">hexs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">hexs</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">dx</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">hexs</span></div>


<div class="viewcode-block" id="rectangle"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.rectangle">[docs]</a><span class="k">def</span> <span class="nf">rectangle</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create the array of pnts to pass on to arcpy using numpy magic</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dx : number</span>
<span class="sd">        Increment in x direction, +ve moves west to east, left/right</span>
<span class="sd">    dy : number</span>
<span class="sd">        Increment in y direction, -ve moves north to south, top/bottom</span>
<span class="sd">    rows, cols : ints</span>
<span class="sd">        Row and columns to produce</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>       <span class="c1"># X, Y values for a unit square</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)))</span>  <span class="c1"># [dx0, dy0] keep for insets</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">seed</span> <span class="o">+</span> <span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dy</span><span class="p">]</span>       <span class="c1"># make the shapes</span>
         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>   <span class="c1"># cycle through the rows</span>
         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">)]</span>  <span class="c1"># cycle through the columns</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span></div>


<div class="viewcode-block" id="triangle"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.triangle">[docs]</a><span class="k">def</span> <span class="nf">triangle</span><span class="p">(</span><span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a row of meshed triangles</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    see rectangle</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">grid_type</span> <span class="o">=</span> <span class="s1">&#39;triangle&#39;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">dx</span><span class="o">/</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span><span class="o">*</span><span class="mf">1.5</span>
    <span class="n">Xu</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>   <span class="c1"># X, Y values for a unit triangle, point up</span>
    <span class="n">Yu</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="n">Xd</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>       <span class="c1"># X, Y values for a unit triangle, point down</span>
    <span class="n">Yd</span> <span class="o">=</span> <span class="p">[</span><span class="n">dy</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">dy</span><span class="p">]</span>   <span class="c1"># shifted by dx</span>
    <span class="n">seedU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Xu</span><span class="p">,</span> <span class="n">Yu</span><span class="p">)))</span>
    <span class="n">seedD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Xd</span><span class="p">,</span> <span class="n">Yd</span><span class="p">)))</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">seedU</span><span class="p">,</span> <span class="n">seedD</span><span class="p">])</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">seed</span> <span class="o">+</span> <span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dy</span><span class="p">]</span>       <span class="c1"># make the shapes</span>
         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="p">)</span>       <span class="c1"># cycle through the rows</span>
         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="p">)]</span>      <span class="c1"># cycle through the columns</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">s4</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s1</span><span class="o">*</span><span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">s4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">grid_type</span></div>


<div class="viewcode-block" id="pnt_from_dist_bearing"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.pnt_from_dist_bearing">[docs]</a><span class="k">def</span> <span class="nf">pnt_from_dist_bearing</span><span class="p">(</span><span class="n">orig</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">bearings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prn</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Point locations given distance and bearing from an origin.</span>
<span class="sd">    Calculate the point coordinates from distance and angle</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    `&lt;https://community.esri.com/thread/66222&gt;`_.</span>

<span class="sd">    `&lt;https://community.esri.com/blogs/dan_patterson/2018/01/21/</span>
<span class="sd">    origin-distances-and-bearings-geometry-wanderings&gt;`_.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Sample calculation::</span>

<span class="sd">        bearings = np.arange(0, 361, 22.5)  # 17 bearings</span>
<span class="sd">        dists = np.random.randint(10, 500, len(bearings)) * 1.0  OR</span>
<span class="sd">        dists = np.full(bearings.shape, 100.)</span>
<span class="sd">        data = dist_bearing(orig=orig, bearings=bearings, dists=dists)</span>

<span class="sd">    Create a featureclass from the results::</span>

<span class="sd">        shapeXY = [&#39;X_to&#39;, &#39;Y_to&#39;]</span>
<span class="sd">        fc_name = &#39;C:/path/Geodatabase.gdb/featureclassname&#39;</span>
<span class="sd">        arcpy.da.NumPyArrayToFeatureClass(out, fc_name,</span>
<span class="sd">                                          [&#39;X_to&#39;, &#39;Y_to&#39;], &quot;2951&quot;)</span>
<span class="sd">        # ... syntax</span>
<span class="sd">        arcpy.da.NumPyArrayToFeatureClass(in_array=out,</span>
<span class="sd">                                          out_table=fc_name,</span>
<span class="sd">                                          shape_fields=shapeXY,</span>
<span class="sd">                                          spatial_reference=SR)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bearings</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dists</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;origin with distances and bearings required&quot;</span>
    <span class="n">orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">orig</span><span class="p">)</span>
    <span class="n">rads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">bearings</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rads</span><span class="p">)</span> <span class="o">*</span> <span class="n">dists</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rads</span><span class="p">)</span> <span class="o">*</span> <span class="n">dists</span>
    <span class="n">x_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="n">orig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">+</span> <span class="n">orig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">y_t</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dists</span><span class="p">,</span> <span class="n">bearings</span><span class="p">)</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X_to&quot;</span><span class="p">,</span> <span class="s2">&quot;Y_to&quot;</span><span class="p">,</span> <span class="s2">&quot;orig_dx&quot;</span><span class="p">,</span> <span class="s2">&quot;orig_dy&quot;</span><span class="p">,</span> <span class="s2">&quot;distance&quot;</span><span class="p">,</span> <span class="s2">&quot;bearing&quot;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">prn</span><span class="p">:</span>  <span class="c1"># ---- just print the results ----------------------------------</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;Origin (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">orig</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{:&gt;10s}</span><span class="s2">&quot;</span><span class="o">*</span><span class="n">N</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">))</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{: 10.2f}</span><span class="s2">&quot;</span><span class="o">*</span><span class="n">N</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="c1"># ---- produce a structured array from the output -----------------------</span>
    <span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;f8&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">fromarrays</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="xy_grid"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.xy_grid">[docs]</a><span class="k">def</span> <span class="nf">xy_grid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_left</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a 2D array of locations from x, y values.  The values need not</span>
<span class="sd">    be uniformly spaced just sequential. Derived from `meshgrid` in References.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x, y : array-like</span>
<span class="sd">        To form a mesh, there must at least be 2 values in each sequence</span>
<span class="sd">    top_left: boolean</span>
<span class="sd">        True, y&#39;s are sorted in descending order, x&#39;s in ascending</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    `&lt;https://github.com/numpy/numpy/blob/master/numpy/lib/function_base.py&gt;`_.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;A 1D array required&quot;</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">top_left</span><span class="p">:</span>
        <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">ys</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">newshape</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">xs</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">newshape</span><span class="o">=</span><span class="p">(</span><span class="n">ys</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)))</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="p">[</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">]</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_arrays</span><span class="p">(</span><span class="o">*</span><span class="n">xy</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">shp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">shp</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xs</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">final</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">final</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">final</span></div>


<div class="viewcode-block" id="transect_lines"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.create.transect_lines">[docs]</a><span class="k">def</span> <span class="nf">transect_lines</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">orig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">bearing</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">as_ndarray</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct transect lines from origin-destination points given a</span>
<span class="sd">    distance and bearing from the origin point</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N : number</span>
<span class="sd">        The number of transect lines</span>
<span class="sd">    orig : array-like</span>
<span class="sd">         A single origin.  If None, the cartesian origin (0, 0) is used</span>
<span class="sd">    dist : number or array-like</span>
<span class="sd">        The distance(s) from the origin</span>
<span class="sd">    x_offset, y_offset : number</span>
<span class="sd">        If the `orig` is a single location, you can construct offset lines</span>
<span class="sd">        using these values</span>
<span class="sd">    bearing : number or array-like</span>
<span class="sd">        If a single number, parallel lines are produced. An array of values</span>
<span class="sd">        equal to the `orig` can be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Two outputs are returned, the first depends on the `as_ndarray` setting.</span>

<span class="sd">    1. True, a structured array. False - a recarray</span>
<span class="sd">    2. An ndarray with the field names in case the raw data are required.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    It is easiest of you pick a `corner`, then use x_offset, y_offset to</span>
<span class="sd">    control whether you are moving horizontally and vertically from the origin.</span>
<span class="sd">    The bottom left is easiest, and positive offsets move east and north from.</span>

<span class="sd">    Use XY to Line tool in ArcGIS Pro to convert the from/to pairs to a line</span>

<span class="sd">    `&lt;http://pro.arcgis.com/en/pro-app/tool-reference/data-management</span>
<span class="sd">    /xy-to-line.htm&gt;`_.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; out, data = transect_lines(N=5, orig=None,</span>
<span class="sd">                                   dist=100, x_offset=10,</span>
<span class="sd">                                   y_offset=0, bearing=45, as_ndarray=True)</span>
<span class="sd">    &gt;&gt;&gt; data</span>
<span class="sd">    array([[  0.  ,   0.  ,  70.71,  70.71],</span>
<span class="sd">           [ 10.  ,   0.  ,  80.71,  70.71],</span>
<span class="sd">           [ 20.  ,   0.  ,  90.71,  70.71],</span>
<span class="sd">           [ 30.  ,   0.  , 100.71,  70.71],</span>
<span class="sd">           [ 40.  ,   0.  , 110.71,  70.71]])</span>
<span class="sd">    &gt;&gt;&gt; out</span>
<span class="sd">    array([( 0., 0.,  70.71, 70.71), (10., 0.,  80.71, 70.71),</span>
<span class="sd">    ...    (20., 0.,  90.71, 70.71), (30., 0., 100.71, 70.71),</span>
<span class="sd">    ...    (40., 0., 110.71, 70.71)],</span>
<span class="sd">    ...   dtype=[(&#39;X_from&#39;, &#39;&lt;f8&#39;), (&#39;Y_from&#39;, &#39;&lt;f8&#39;),</span>
<span class="sd">    ...          (&#39;X_to&#39;, &#39;&lt;f8&#39;), (&#39;Y_to&#39;, &#39;&lt;f8&#39;)])</span>
<span class="sd">    ...</span>
<span class="sd">    ... Create the table and the lines</span>
<span class="sd">    &gt;&gt;&gt; tbl = &#39;c:/folder/your.gdb/table_name&#39;</span>
<span class="sd">    &gt;&gt;&gt; # arcpy.da.NumPyArrayToTable(a, tbl)</span>
<span class="sd">    &gt;&gt;&gt; # arcpy.XYToLine_management(</span>
<span class="sd">    ...        in_table, out_featureclass,</span>
<span class="sd">    ...        startx_field, starty_field, endx_field, endy_field,</span>
<span class="sd">    ...        {line_type}, {id_field}, {spatial_reference}</span>
<span class="sd">    ... This is general syntax, the first two are paths of source and output</span>
<span class="sd">    ... files, followed by coordinates and options parameters.</span>
<span class="sd">    ...</span>
<span class="sd">    ... To create compass lines</span>
<span class="sd">    &gt;&gt;&gt; b = np.arange(0, 361, 22.5)</span>
<span class="sd">    &gt;&gt;&gt; a, data =transect_lines(N=10, orig=[299000, 4999000],</span>
<span class="sd">                               dist=100, x_offset=0, y_offset=0,</span>
<span class="sd">                               bearing=b, as_ndarray=True)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    `&lt;https://community.esri.com/blogs/dan_patterson/2019/01/17/transect-</span>
<span class="sd">    lines-parallel-lines-offset-lines&gt;`__</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_array_struct_</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">fld_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">kinds</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Convert an array to a structured array&quot;&quot;&quot;</span>
        <span class="n">dts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fld_names</span><span class="p">,</span> <span class="n">kinds</span><span class="p">))</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dts</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">z</span><span class="p">[</span><span class="n">fld_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">z</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">orig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">orig</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">bearing</span><span class="p">]</span>
    <span class="n">arrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">args</span><span class="p">]</span>
    <span class="n">orig</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">bearing</span> <span class="o">=</span> <span class="n">arrs</span>
    <span class="c1"># o_shp, d_shp, b_shp = [i.shape for i in arrs]</span>
    <span class="c1">#</span>
    <span class="n">rads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rads</span><span class="p">)</span> <span class="o">*</span> <span class="n">dist</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rads</span><span class="p">)</span> <span class="o">*</span> <span class="n">dist</span>
    <span class="c1">#</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bearing</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">n</span><span class="p">][</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># either the number of lines or bearings</span>
    <span class="n">x_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_offset</span> <span class="o">+</span> <span class="n">orig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_offset</span> <span class="o">+</span> <span class="n">orig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x_dest</span> <span class="o">=</span> <span class="n">x_orig</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="n">y_dest</span> <span class="o">=</span> <span class="n">y_orig</span> <span class="o">+</span> <span class="n">dy</span>
    <span class="c1"># ---- create the output array</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X_from&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_from&#39;</span><span class="p">,</span> <span class="s1">&#39;X_to&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_to&#39;</span><span class="p">]</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">cols</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_orig</span><span class="p">,</span> <span class="n">y_orig</span><span class="p">,</span> <span class="n">x_dest</span><span class="p">,</span> <span class="n">y_dest</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">as_ndarray</span><span class="p">:</span>  <span class="c1"># **** add this as a flag</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">_array_struct_</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fld_names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">kinds</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">fromarrays</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">,</span> <span class="n">data</span></div>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># __main__ .... code section</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Script path </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Dan Patterson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>