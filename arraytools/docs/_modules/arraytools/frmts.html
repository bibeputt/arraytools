

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arraytools.frmts &mdash; arraytools 0.9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> arraytools
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">arraytools... :</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arraytools_mods.html">Modules in arraytools</a></li>
</ul>
<p class="caption"><span class="caption-text">Sphinx...:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Sphinx_documentation.html">How to document Sphinx</a></li>
</ul>
<p class="caption"><span class="caption-text">ReStructuredText...:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../md_tester.html">Documentation tips</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">arraytools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>arraytools.frmts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for arraytools.frmts</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: UTF-8 -*-</span>
<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">=====</span>
<span class="sd">frmts</span>
<span class="sd">=====</span>

<span class="sd">Script:   frmts.py</span>

<span class="sd">Author:   Dan_Patterson@carleton.ca</span>

<span class="sd">Modified: 2019-02-01</span>

<span class="sd">References</span>
<span class="sd">----------</span>
<span class="sd">`np.set_printoptions` and `np.printoptions`</span>

<span class="sd">`&lt;https://github.com/numpy/numpy/blob/master/numpy/core/arrayprint.py&gt;`_.</span>

<span class="sd">&gt;&gt;&gt; set_printoptions(precision=3, threshold=100, edgeitems=3, linewidth=80,</span>
<span class="sd">                     suppress=True, nanstr=&#39;nan&#39;, infstr=&#39;inf&#39;,</span>
<span class="sd">                     formatter=None, sign=None, floatmode=None, **kwarg)</span>

<span class="sd">&gt;&gt;&gt; with np.printoptions(precision=deci, linewidth=ln_wdth):</span>
<span class="sd">        print(a)  # the original options will be reset after printing</span>


<span class="sd">Unicode::</span>

<span class="sd">    Originals had a `u` in front of the single quotes</span>
<span class="sd">    arrows</span>
<span class="sd">    - &#39;⇐ ⇑ ⇒ ⇓&#39;: &quot;{} {} {} {}&quot;.format(&#39;\u21D0&#39;, &#39;\u21D1&#39;,</span>
<span class="sd">        &#39;\u21D2&#39;,  &#39;\u21D3&#39;)</span>
<span class="sd">    </span>
<span class="sd">    box drawing</span>
<span class="sd">    - &#39;╔═══╗&#39; : &#39;{}{}{}&#39;.format(&#39;\u2554&#39;, &#39;\u2550&#39;*3, &#39;\u2557&#39;)</span>
<span class="sd">    - &#39;║ A ║&#39; : `{}{}{}&#39;.format(&#39;\u2551&#39;, &#39; A &#39;, &#39;\u2551&#39;)</span>
<span class="sd">    - &#39;╚═══╝&#39; : &#39;{}{}{}&#39;.format(&#39;\u255A&#39;, &#39;\u2550&#39;*3, &#39;\u255D&#39;)</span>

<span class="sd">`&lt;https://en.wikipedia.org/wiki/List_of_Unicode_characters#Arrows&gt;`_.</span>
<span class="sd">`&lt;https://en.wikipedia.org/wiki/List_of_Unicode_characters#Box_Drawing&gt;`_.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#    Notes</span>
<span class="c1">#    -----</span>
<span class="c1">#    </span>
<span class="c1">#    The prn2d function is used to provide a side-by-side view of 2, 3, and 4D</span>
<span class="c1">#    arrays.  Specifically, 3D and 4D arrays are useful and for testing</span>
<span class="c1">#    purposes, seeing the dimensions in a different view can facilitate</span>
<span class="c1">#    understanding.  For the best effect, the array shapes should be carefully</span>
<span class="c1">#    considered. Some guidelines follow.  The middle &#39;r&#39; part of the shape is</span>
<span class="c1">#    not as affected as the combination of the &#39;d&#39; and &#39;c&#39; parts.  The array is</span>
<span class="c1">#    trimmed beyond the &#39;width&#39; parameter in prn2d.</span>
<span class="c1">#    </span>
<span class="c1">#    Sample the 3D array shape so that the format (d, r, c)</span>
<span class="c1">#    is within the 20-21 range for d*c ... for example::</span>
<span class="c1">#            integers          floats</span>
<span class="c1">#            2, r, 10  = 20    2, r, 8 = 16</span>
<span class="c1">#            3, r,  7  = 21    3, 4, 5 = 15</span>
<span class="c1">#            4, r,  5  = 20    4, r, 4 = 16</span>
<span class="c1">#            5, r,  4  = 20    5, r, 3 = 15</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; prn2d(a)  example for a =  np.arange(3*4*5).reshape(3, 4, 5)</span>
<span class="c1">#    ---------------------------------------------------</span>
<span class="c1">#    Array...</span>
<span class="c1">#    -shape (3, 4, 5), ndim 3</span>
<span class="c1">#      .  0  1  2  3  4    20 21 22 23 24    40 41 42 43 44</span>
<span class="c1">#      .  5  6  7  8  9    25 26 27 28 29    45 46 47 48 49</span>
<span class="c1">#      . 10 11 12 13 14    30 31 32 33 34    50 51 52 53 54</span>
<span class="c1">#      . 15 16 17 18 19    35 36 37 38 39    55 56 57 58 59</span>
<span class="c1">#      .   sub (0 )        : sub (1 )        : sub (2 )</span>
<span class="c1">#    </span>
<span class="c1">#    The middle part of the shape should also be reasonable should you want</span>
<span class="c1">#    to print the results:</span>
<span class="c1">#    </span>
<span class="c1">#    How it works</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; a[...,0,:].flatten()</span>
<span class="c1">#    array([ 0,  1,  2,  3,  4, 20, 21, 22, 23, 24, 40, 41, 42, 43, 44])</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; a[...,0,(0, 1, -2, -1)].flatten()</span>
<span class="c1">#    array([ 0,  1,  3,  3, 20, 21, 23, 23, 40, 41, 43, 43])</span>
<span class="c1">#    </span>
<span class="c1">#</span>
<span class="c1">#Functions:</span>
<span class="c1">#=========</span>
<span class="c1">#    help(&lt;function name&gt;) for help</span>
<span class="c1">#    </span>
<span class="c1">#    ::</span>
<span class="c1">#    </span>
<span class="c1">#        public  -  private...</span>
<span class="c1">#        deline  -  _pre</span>
<span class="c1">#        prn2d   - _check, _concat, _row_format</span>
<span class="c1">#        prn_ma - _fix</span>
<span class="c1">#        in_by   - _pre_num</span>
<span class="c1">#    </span>
<span class="c1">#     ... see __all__ for a complete listing</span>
<span class="c1">#    </span>
<span class="c1">#    1(a) col_hdr() :</span>
<span class="c1">#    </span>
<span class="c1">#    produce column headers to align output for formatting purposes</span>
<span class="c1">#    </span>
<span class="c1">#    ``.........1.........2.........3.........4.........5.........6.........</span>
<span class="c1">#    123456789012345678901234567890123456789012345678901234567890123456789``</span>
<span class="c1">#    </span>
<span class="c1">#    ----------------------------------------------------------------------</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    1(b)  deline(a)::</span>
<span class="c1">#    </span>
<span class="c1">#         shp = (2,3,4)</span>
<span class="c1">#         a = np.arange(np.prod(shp)).reshape(shp)</span>
<span class="c1">#         deline(a)</span>
<span class="c1">#    </span>
<span class="c1">#         Main array...</span>
<span class="c1">#         ndim: 3 size: 24</span>
<span class="c1">#         shape: (2, 3, 4)</span>
<span class="c1">#         [[[ 0  1  2  3]</span>
<span class="c1">#           [ 4  5  6  7]</span>
<span class="c1">#           [ 8  9 10 11]]</span>
<span class="c1">#         a[1]....</span>
<span class="c1">#          [[12 13 14 15]</span>
<span class="c1">#           [16 17 18 19]</span>
<span class="c1">#           [20 21 22 23]]]</span>
<span class="c1">#    </span>
<span class="c1">#    (1c) in_by</span>
<span class="c1">#    </span>
<span class="c1">#    indent objects, added automatic support for arrays and optional line numbers</span>
<span class="c1">#    ::</span>
<span class="c1">#         a = np.arange(2*3*4).reshape(2,3,4)</span>
<span class="c1">#         print(art.in_by(a, hdr=&#39;---- header ----&#39;, nums=True, prefix =&quot;..&quot;))</span>
<span class="c1">#         ---- header ----</span>
<span class="c1">#         00..[[[ 0  1  2  3]</span>
<span class="c1">#         01..  [ 4  5  6  7]</span>
<span class="c1">#         02..  [ 8  9 10 11]]</span>
<span class="c1">#         03..</span>
<span class="c1">#         04.. [[12 13 14 15]</span>
<span class="c1">#         05..  [16 17 18 19]</span>
<span class="c1">#         06..  [20 21 22 23]]]</span>
<span class="c1">#    </span>
<span class="c1">#    (1d)  redent(lines, spaces=4)</span>
<span class="c1">#    ::</span>
<span class="c1">#         a = np.arange(3*5).reshape(3,5)</span>
<span class="c1">#         &gt;&gt;&gt; print(redent(a))</span>
<span class="c1">#         |    [[ 0  1  2  3  4]</span>
<span class="c1">#         |     [ 5  6  7  8  9]</span>
<span class="c1">#         |     [10 11 12 13 14]]</span>
<span class="c1">#</span>
<span class="c1">#(2) prn2d(a)</span>
<span class="c1">#::</span>
<span class="c1">#   a = np.arange(2*3*3).reshape(2,3,3)</span>
<span class="c1">#   array([[[ 0,  1,  2],</span>
<span class="c1">#           [ 3,  4,  5],</span>
<span class="c1">#           [ 6,  7,  8]],</span>
<span class="c1">#</span>
<span class="c1">#          [[ 9, 10, 11],</span>
<span class="c1">#           [12, 13, 14],</span>
<span class="c1">#           [15, 16, 17]]])</span>
<span class="c1">#   prn2d(a)</span>
<span class="c1">#   Array... shape (2, 3, 3), ndim 3, not masked</span>
<span class="c1">#    0,  1,  2     9, 10, 11</span>
<span class="c1">#    3,  4,  5    12, 13, 14</span>
<span class="c1">#    6,  7,  8    15, 16, 17</span>
<span class="c1">#   sub (0)       sub (1)</span>
<span class="c1">#</span>
<span class="c1">#(3) prn_ma</span>
<span class="c1">#::</span>
<span class="c1">#    :--------------------</span>
<span class="c1">#    :Masked array........</span>
<span class="c1">#    :  ndim: 2 size: 20</span>
<span class="c1">#    :  shape: (5, 4)</span>
<span class="c1">#    :</span>
<span class="c1">#    :... a[:5, :4] ...</span>
<span class="c1">#      -  1  2  3</span>
<span class="c1">#      4  5  6  7</span>
<span class="c1">#      8  -  -  -</span>
<span class="c1">#     12 13 14 15</span>
<span class="c1">#     16 17 18  -</span>
<span class="c1">#</span>
<span class="c1">#(4) pd and quick_prn</span>
<span class="c1">#    see code</span>
<span class="c1">#</span>
<span class="c1">#(5) prn_struct and prn_rec : main functions</span>
<span class="c1">#        _col_kind_width, _col_format,subsample</span>
<span class="c1">#</span>
<span class="c1">#prn_struct(b, edges=3, max_lines=10, width=100, deci=2)</span>
<span class="c1">#::</span>
<span class="c1">#    OBJECTID   f0   County  Town  Facility  Time</span>
<span class="c1">#    ----------------------------------------------</span>
<span class="c1">#             1    0 B       A_    Hall          26</span>
<span class="c1">#             2    1 C       C_    Hall          60</span>
<span class="c1">#             3    2 D       A_    Hall          42</span>
<span class="c1">#           ...  ...     ...   ...       ...</span>
<span class="c1">#            18   17 A       C_    Hall          59</span>
<span class="c1">#            19   18 C       C_    Hosp          37</span>
<span class="c1">#            20   19 B       B_    Hall          52</span>
<span class="c1">#</span>
<span class="c1">#    Array... shape: (20,)</span>
<span class="c1">#</span>
<span class="c1">#prn_rec(a, edges=5, max_rows=25, deci=2)</span>
<span class="c1">#::</span>
<span class="c1">#    Format ... C:/Git_Dan/arraytools/Data/sample_20.npy</span>
<span class="c1">#    record/structured array, with and without field names.</span>
<span class="c1">#    --n-- OBJECTID   f0  County  Town  Facility  Time``</span>
<span class="c1">#    -------------------------------------------------</span>
<span class="c1">#    000         1    0       B    A_      Hall    26</span>
<span class="c1">#    001         2    1       C    C_      Hall    60</span>
<span class="c1">#    002         3    2       D    A_      Hall    42</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#(6) make_row_format</span>
<span class="c1">#::</span>
<span class="c1">#    make_row_format(dim=2, cols=3, a_kind=&#39;f&#39;, deci=1,</span>
<span class="c1">#                    a_max=10, a_min=-10, prn=False)</span>
<span class="c1">#    &#39;{:6.1f}{:6.1f}{:6.1f}  {:6.1f}{:6.1f}{:6.1f}&#39;</span>
<span class="c1">#</span>
<span class="c1">#prn_</span>
<span class="c1">#::</span>
<span class="c1">#  prn_(a, deci=2, width=100, title=&quot;Array&quot;, prefix=&quot;. . &quot;, prnt=True)</span>
<span class="c1">#</span>
<span class="c1">#  Array... ndim: 3  shape: (2, 3, 3)</span>
<span class="c1">#  . .   0  1  2    9 10 11</span>
<span class="c1">#  . .   3  4  5   12 13 14</span>
<span class="c1">#  . .   6  7  8   15 16 17</span>
<span class="c1">#</span>
<span class="c1">#(7)  prn_3d4d(a, deci=2, edgeitems=3, width=100, prnt=True)</span>
<span class="c1">#::</span>
<span class="c1">#    prn_3d4d(z)</span>
<span class="c1">#    Array... ndim 4  shape(1, 2, 3, 4)</span>
<span class="c1">#    |  0  1  2  3   12 13 14 15 |</span>
<span class="c1">#    |  4  5  6  7   16 17 18 19 |</span>
<span class="c1">#    |  8  9 10 11   20 21 22 23 |</span>
<span class="c1">#    |=&gt; (0 2 3 4)</span>

<span class="c1">#    Notes</span>
<span class="c1">#    =====</span>
<span class="c1">#    </span>
<span class="c1">#    **column numbering**</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; d = ((&#39;{:&lt;10}&#39;)*7).format(*&#39;0123456789&#39;), &#39;0123456789&#39;*7, &#39;-&#39;*70</span>
<span class="c1">#    &gt;&gt;&gt; s = &#39;\n{}\n{}\n{}&#39;.format(args[0][1:], args[1][1:], args[2]) #*args)</span>
<span class="c1">#    &gt;&gt;&gt; print(s)</span>
<span class="c1">#                 1         2         3         4         5         6</span>
<span class="c1">#        123456789012345678901234567890123456789012345678901234567890123456789</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    **Getting default print options, then setting them back **</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; pr_opt = np.get_printoptions()</span>
<span class="c1">#    &gt;&gt;&gt; df_opt = &quot;, &quot;.join([&quot;{}={}&quot;.format(i, pr_opt[i]) for i in pr_opt])</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    ** Rearranging blocks into columns using np.c_[...] **</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt;  a = np.arange(3*2*3).reshape(3, 2, 3)</span>
<span class="c1">#    &gt;&gt;&gt;  a_max = a.max()</span>
<span class="c1">#    &gt;&gt;&gt;  a_min = a.min()</span>
<span class="c1">#    &gt;&gt;&gt;  aa = np.c_[(a[0], a[1], a[2])]</span>
<span class="c1">#    &gt;&gt;&gt;  d, r, c = a.shape</span>
<span class="c1">#    &gt;&gt;&gt;  deci = 1</span>
<span class="c1">#    &gt;&gt;&gt;  a_kind = a.dtype.kind</span>
<span class="c1">#    &gt;&gt;&gt;  f = _format_row_test(d, r, c, a_kind, deci, a_max, a_min)</span>
<span class="c1">#    ::</span>
<span class="c1">#    Row format given</span>
<span class="c1">#    d 3, r 2, c 3</span>
<span class="c1">#    kind i decimals 1</span>
<span class="c1">#    {:3.0f}{:3.0f}{:3.0f}  {:3.0f}{:3.0f}{:3.0f}  {:3.0f}{:3.0f}{:3.0f}</span>
<span class="c1">#    0123456789012345678901234567890123456789012345678901234567890123456789</span>
<span class="c1">#    0         1         2         3         4         5         6</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt;  r = `\\n`.join([f.format(*i) for i in aa])</span>
<span class="c1">#    &gt;&gt;&gt;  print(r)</span>
<span class="c1">#      0  1  2    6  7  8   12 13 14</span>
<span class="c1">#      3  4  5    9 10 11   15 16 17</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; # Now change dtype and decimals</span>
<span class="c1">#    &gt;&gt;&gt;  a_kind = &#39;f&#39;</span>
<span class="c1">#    &gt;&gt;&gt;  deci = 2</span>
<span class="c1">#    &gt;&gt;&gt;  f = _format_row_test(d, r, c, a_kind, deci, a_max, a_min)</span>
<span class="c1">#     .... snip ....</span>
<span class="c1">#    &gt;&gt;&gt;  print(r)</span>
<span class="c1">#      0.00  1.00  2.00    6.00  7.00  8.00   12.00 13.00 14.00</span>
<span class="c1">#      3.00  4.00  5.00    9.00 10.00 11.00   15.00 16.00 17.00</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    **all at once**</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; a</span>
<span class="c1">#    array([[[ 0,  1,  2,  3],</span>
<span class="c1">#            [ 4,  5,  6,  7],</span>
<span class="c1">#            [ 8,  9, 10, 11]],</span>
<span class="c1">#           [[12, 13, 14, 15],</span>
<span class="c1">#            [16, 17, 18, 19],</span>
<span class="c1">#            [20, 21, 22, 23]]])</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt;  s0, s1, s2 = a.shape</span>
<span class="c1">#    &gt;&gt;&gt;  b = a.swapaxes(2, 1).reshape(s0*s2, s1).T</span>
<span class="c1">#    &gt;&gt;&gt;  b</span>
<span class="c1">#      array([[ 0,  1,  2,  3, 12, 13, 14, 15],</span>
<span class="c1">#             [ 4,  5,  6,  7, 16, 17, 18, 19],</span>
<span class="c1">#             [ 8,  9, 10, 11, 20, 21, 22, 23]])</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    Masked array info:</span>
<span class="c1">#    ------------------</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt;  a.get_fill_value() # see default_filler dictionary</span>
<span class="c1">#    &gt;&gt;&gt;  a.set_fill_value(np.NaN)</span>
<span class="c1">#    &gt;&gt;&gt;  np.ma.maximum_fill_value(a)   -inf</span>
<span class="c1">#    &gt;&gt;&gt;  np.ma.minimum_fill_value(a)    inf</span>
<span class="c1">#    &gt;&gt;&gt;  default_filler =</span>
<span class="c1">#         {&#39;b&#39;: True, &#39;c&#39;: 1.e20 + 0.0j, &#39;f&#39;: 1.e20, &#39;i&#39;: 999999,&#39;O&#39;: &#39;?&#39;,</span>
<span class="c1">#          &#39;S&#39;: b&#39;N/A&#39;, &#39;u&#39;: 999999,&#39;V&#39;: &#39;???&#39;,&#39;U&#39;: sixu(&#39;N/A&#39;)}</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    Others:</span>
<span class="c1">#    ------</span>
<span class="c1">#    </span>
<span class="c1">#    &gt;&gt;&gt; b.transpose(1, 2, 0)[:,:,::-1]</span>
<span class="c1">#    &gt;&gt;&gt; # ** tip *** reorder from after transpose or even a swapaxes</span>
<span class="c1">#    &gt;&gt;&gt; # the ::-1 does the reversing... same as [...,::-1]</span>
<span class="c1">#    </span>

<span class="c1"># ---- imports, formats, constants ----</span>

<span class="c1"># pylint: disable=C0103  # invalid-name</span>
<span class="c1"># pylint: disable=R0914  # Too many local variables</span>
<span class="c1"># pylint: disable=R1710  # inconsistent-return-statements</span>
<span class="c1"># pylint: disable=W0105  # string statement has no effect</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="k">import</span> <span class="n">dedent</span><span class="p">,</span> <span class="n">indent</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ft</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bool&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)),</span>
      <span class="s1">&#39;float_kind&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{!r: 0.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">}</span>
<span class="n">edge</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">ln_wdth</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">thresh</span> <span class="o">=</span><span class="mi">50</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="n">edge</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">ln_wdth</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nanstr</span><span class="o">=</span><span class="s1">&#39;-n-&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">thresh</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="n">ft</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_print_option</span><span class="o">.</span><span class="n">set_display</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>  <span class="c1"># change to a single -</span>

<span class="n">pr_opt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">get_printoptions</span><span class="p">()</span>
<span class="n">df_opt</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">pr_opt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pr_opt</span><span class="p">])</span>

<span class="n">script</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;col_hdr&#39;</span><span class="p">,</span>            <span class="c1"># column headers</span>
           <span class="s1">&#39;xy_dist_headers&#39;</span><span class="p">,</span>    <span class="c1"># table dtype format</span>
           <span class="s1">&#39;deline&#39;</span><span class="p">,</span>             <span class="c1"># remove excessive blank lines</span>
           <span class="s1">&#39;in_by&#39;</span><span class="p">,</span>              <span class="c1"># an indent variant with options</span>
           <span class="s1">&#39;redent&#39;</span><span class="p">,</span>             <span class="c1"># indent</span>
           <span class="s1">&#39;_chunks&#39;</span><span class="p">,</span>            <span class="c1"># take chunks of stuff</span>
           <span class="s1">&#39;head_tail&#39;</span><span class="p">,</span>          <span class="c1"># return the head/tail of a 1d array</span>
           <span class="s1">&#39;_check&#39;</span><span class="p">,</span>             <span class="c1"># helper functions</span>
           <span class="s1">&#39;_slice_rows&#39;</span><span class="p">,</span>        <span class="c1">#</span>
           <span class="s1">&#39;_slice_cols&#39;</span><span class="p">,</span>        <span class="c1">#</span>
           <span class="s1">&#39;_slice_head_tail&#39;</span><span class="p">,</span>   <span class="c1">#</span>
           <span class="s1">&#39;_col_format&#39;</span><span class="p">,</span>        <span class="c1"># printing section</span>
           <span class="s1">&#39;prn_nd&#39;</span><span class="p">,</span>             <span class="c1"># for ndarray</span>
           <span class="s1">&#39;prn_ma&#39;</span><span class="p">,</span>             <span class="c1"># for masked arrays</span>
           <span class="s1">&#39;prn_rec&#39;</span><span class="p">,</span> <span class="s1">&#39;pd_&#39;</span><span class="p">,</span>     <span class="c1"># record/structured arrays</span>
           <span class="s1">&#39;prn_struct&#39;</span><span class="p">,</span>         <span class="c1">#</span>
           <span class="s1">&#39;make_row_format&#39;</span><span class="p">,</span>    <span class="c1"># a big helper function</span>
           <span class="s1">&#39;prn_&#39;</span><span class="p">,</span>               <span class="c1"># ndarray variant</span>
           <span class="s1">&#39;prn&#39;</span>        <span class="c1"># ---- this def is used to call all the others ----</span>
           <span class="p">]</span>

<span class="n">FLOATS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">typecodes</span><span class="p">[</span><span class="s1">&#39;AllFloat&#39;</span><span class="p">]</span>
<span class="n">INTS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">typecodes</span><span class="p">[</span><span class="s1">&#39;AllInteger&#39;</span><span class="p">]</span>
<span class="n">NUMS</span> <span class="o">=</span> <span class="n">FLOATS</span> <span class="o">+</span> <span class="n">INTS</span>

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (1) Short, or reused code section</span>
<span class="c1">#</span>
<span class="c1"># (1a) col_hdr ... code section .....</span>
<div class="viewcode-block" id="col_hdr"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.col_hdr">[docs]</a><span class="k">def</span> <span class="nf">col_hdr</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print numbers from 1 to 10*num to show column positions&quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[((</span><span class="s1">&#39;</span><span class="si">{:&lt;10}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="s1">&#39;0123456789&#39;</span><span class="p">),</span>
            <span class="s1">&#39;0123456789&#39;</span><span class="o">*</span><span class="n">num</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="n">num</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># *args)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="xy_dist_headers"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.xy_dist_headers">[docs]</a><span class="k">def</span> <span class="nf">xy_dist_headers</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Construct headers for the optional table output&quot;&quot;&quot;</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Y_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;d_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">))]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&lt;f8&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span></div>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (1b) deline ... code section .....</span>
<div class="viewcode-block" id="deline"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.deline">[docs]</a><span class="k">def</span> <span class="nf">deline</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;Array...&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;  .&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove extraneous lines from array output.</span>
<span class="sd">    More useful for long arrays with ndim &gt;= 3</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    `a` : anything</span>
<span class="sd">        anything that can be put into array form</span>
<span class="sd">    `header` :</span>
<span class="sd">        an optional header</span>
<span class="sd">    `prefix` : text</span>
<span class="sd">        could be just spaces or something like shown</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pre</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
            <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">frmt</span>
    <span class="c1"># ----</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="n">header</span> <span class="o">+=</span> <span class="s2">&quot; shape: </span><span class="si">{}</span><span class="s2"> ndim: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;:arr[</span><span class="si">{}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;, :</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">]</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">a_s</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="o">*</span><span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># ---- uses f1 format above</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_s</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">_pre</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">out</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">prefix</span><span class="p">])</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="n">edge</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>
    <span class="c1"># ----</span>


<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># (1c) in_by .... code section</span>
<div class="viewcode-block" id="in_by"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.in_by">[docs]</a><span class="k">def</span> <span class="nf">in_by</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">hdr</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">line_nums</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;   .&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A `textwrap.indent` variant for python 2.7 or a substitute for</span>
<span class="sd">    any version of python.  The function stands for `indent by`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    `obj` : object that can be cast as string</span>
<span class="sd">        obj to indent, List, tuple, ndarray converted to strings</span>
<span class="sd">        first. You can use repr representation before using if needed.</span>
<span class="sd">    `hdr` : text</span>
<span class="sd">        optional header</span>
<span class="sd">    `line_nums` : boolean</span>
<span class="sd">        True to add line numbers</span>
<span class="sd">    `prefix` : test</span>
<span class="sd">        Text to use for indent ie &#39;  &#39; for 2 spaces or &#39;....&#39;</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    [1] https://docs.python.org/3.7/library/textwrap.html for python &gt; 3.3</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        Header and line numbers options added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_pre_num</span><span class="p">():</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">splitlines</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">line_nums</span><span class="p">:</span>
                <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:&gt;02}{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">frmt</span>
            <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">hdr</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hdr</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">hdr</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_pre_num</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>
    <span class="c1"># ----</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (1d) redent .... code section</span>
<div class="viewcode-block" id="redent"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.redent">[docs]</a><span class="k">def</span> <span class="nf">redent</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">spaces</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Strip and reindent by num_spaces, a sequence of lines</span>

<span class="sd">    `lines` : text</span>
<span class="sd">        Text or what can be made text</span>
<span class="sd">        Use str() or repr() on the inputs if you want control on form</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">        See `in_by` for more options</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
    <span class="n">spn</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">*</span><span class="n">spaces</span>
    <span class="n">out</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">sp</span><span class="p">))</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">{1!s:&gt;</span><span class="si">{2}</span><span class="s2">}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spn</span><span class="p">,</span> <span class="o">*</span><span class="n">ln</span><span class="p">)</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">out</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ret</span></div>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (1e) _chunks .... code section</span>
<span class="k">def</span> <span class="nf">_chunks</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Produce n-sized chunks from s.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">s</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">start</span><span class="o">+</span><span class="n">n</span><span class="p">]</span>

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (1f) head_tail  .... code section</span>
<span class="c1">#</span>
<div class="viewcode-block" id="head_tail"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.head_tail">[docs]</a><span class="k">def</span> <span class="nf">head_tail</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Slice `head` and `tail` elements of a 1D array of a given `size`.</span>
<span class="sd">    Optionally, insert a middle `fill` element.</span>

<span class="sd">    &gt;&gt;&gt; head_tail(size=10, head=3, tail=None, fill=None)</span>
<span class="sd">    [0, 1, 2, 7, 8, 9]</span>
<span class="sd">    &gt;&gt;&gt; head_tail(size=10, head=3, tail=None, fill=&quot;...&quot;)</span>
<span class="sd">    [0, 1, 2, &#39;...&#39;, 7, 8, 9]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">head</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">head</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">tail</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tail</span> <span class="o">=</span> <span class="n">head</span>
    <span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">]]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">fill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">head</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="n">tail</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">head</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">fill</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="o">-</span><span class="n">tail</span><span class="p">:]</span></div>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># ---- Format section ---- functions and constants must be used ----</span>

<span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check dtype and max value for formatting information&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_slice_rows</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge_rows</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split an array keeping `edge_rows` from the start and end of the array.</span>
<span class="sd">    Used by `prn_struct` and `prn_rec`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">edge_rows</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">a</span><span class="p">[:</span><span class="n">edge_rows</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="n">edge_rows</span><span class="p">:]))</span>  <span class="c1"># top, bott</span>


<span class="k">def</span> <span class="nf">_slice_cols</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge_cols</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split a structured array keeping `edge_cols from the start of an array.</span>
<span class="sd">    Used by `prn_struct` and `prn_rec`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">names</span><span class="p">[:</span><span class="n">edge_cols</span><span class="p">])]</span>


<span class="k">def</span> <span class="nf">_slice_head_tail</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge_cols</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split a structuredarray keeping `edge_cols` from the start and end.</span>
<span class="sd">    Used by `prn_struct` and `prn_rec`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
    <span class="n">shp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">names</span><span class="p">[:</span><span class="n">edge_cols</span><span class="p">]]</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="o">-</span><span class="n">edge_cols</span><span class="p">:]]</span>
    <span class="n">dt_new</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">descr</span><span class="p">)</span> <span class="o">+</span> <span class="p">[(</span><span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="s1">&#39;3U&#39;</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">descr</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">shp</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dt_new</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
        <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">z</span><span class="p">[</span><span class="s1">&#39;...&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;...&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">shp</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
        <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">a</span>
    <span class="k">return</span> <span class="n">z</span>


<span class="k">def</span> <span class="nf">_row_format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create format string from array parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    array parameters: _check function</span>
<span class="sd">        a.shape, a.ndim, a.dtype.kind, a.max(), a.min()</span>
<span class="sd">    sep : string</span>
<span class="sd">        A separator for parts of the array</span>
<span class="sd">    deci : integer</span>
<span class="sd">        Number of decimal places to use for all floats</span>
<span class="sd">    constants : numbers</span>
<span class="sd">        float and int as defined above</span>
<span class="sd">    _check : function</span>
<span class="sd">        Returns base array information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shp</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">kind</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="n">a_min</span> <span class="o">=</span> <span class="n">_check</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># get base array information</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">shp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">FLOATS</span><span class="p">:</span>
        <span class="n">w_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;:</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">f&#39;</span><span class="p">,</span> <span class="s1">&#39;{:0.</span><span class="si">{}</span><span class="s1">f}&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">INTS</span><span class="p">:</span>
        <span class="n">w_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;:</span><span class="si">{}</span><span class="s1">.0f&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:0.0f}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;!s:&gt;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">deci</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">deci</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">m_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_min</span><span class="p">,</span> <span class="n">deci</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">w_fmt</span> <span class="o">=</span> <span class="n">w_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">deci</span><span class="p">)</span>
    <span class="n">r_fmt</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">w_fmt</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">r_fmt</span>


<span class="k">def</span> <span class="nf">_col_kind_width</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Column properties for ndarray and recarray/structured array types.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    constants : numbers</span>
<span class="sd">        float and int as defined above</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Used by _col_format, prn_rec and prn_struct.  It check the</span>
<span class="sd">    length of the values in the field, rounded to `deci`mal places if needed,</span>
<span class="sd">    That value to the field name length, if found, and returns the `max`.</span>

<span class="sd">    sample output for a structured array :</span>
<span class="sd">        [(&#39;i&#39;, 5), (&#39;U&#39;, 25), (&#39;i&#39;, 5), (&#39;i&#39;, 5)]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_ckw_</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">deci</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;process for arrays with named fields&quot;&quot;&quot;</span>
        <span class="n">c_kind</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">c_kind</span> <span class="ow">in</span> <span class="n">FLOATS</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">deci</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># float with decimals</span>
            <span class="n">c_max</span><span class="p">,</span> <span class="n">c_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">a</span><span class="p">)],</span> <span class="n">deci</span><span class="p">)</span>
            <span class="n">c_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">c_min</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">c_max</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">c_kind</span> <span class="ow">in</span> <span class="n">NUMS</span><span class="p">:</span>      <span class="c1"># int, unsigned int, float wih no decimals</span>
            <span class="n">c_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">c_kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">):</span>
            <span class="n">c_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">c_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">c_width</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">c_kind</span><span class="p">,</span> <span class="n">c_width</span><span class="p">]</span>
    <span class="c1"># ---- constants</span>
    <span class="c1"># ---- call to _ckw_ ----</span>
    <span class="n">dtn</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
    <span class="k">if</span> <span class="n">dtn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># ---- uniform dtype</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">_ckw_</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">_ckw_</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="n">name</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">dtn</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_col_format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c_name</span><span class="o">=</span><span class="s2">&quot;c00&quot;</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine column format for an ndarray or structured array.  The</span>
<span class="sd">    number of decimal places for float fields can be specified.</span>
<span class="sd">    Used by prn_rec.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    `c` : column</span>
<span class="sd">        A column in an array.</span>
<span class="sd">    `c_name` : text</span>
<span class="sd">        column name for ndarrays of uniform dtype.  Ignored otherwise</span>
<span class="sd">    `deci` : int</span>
<span class="sd">        Desired number of decimal points if the data are numeric</span>
<span class="sd">    `_col_kind_width` : function</span>
<span class="sd">        This function does the determination of column kind and width</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    To do all field `names`</span>

<span class="sd">    &gt;&gt;&gt; [_col_format(j) for j in [a[i] for i in names]]</span>
<span class="sd">    [(&#39;:&gt; 6.0f&#39;, 5), (&#39;!s:&lt;26&#39;, 25), (&#39;:&gt; 6.0f&#39;, 5),</span>
<span class="sd">     (&#39;:&gt; 6.0f&#39;, 5), (&#39;:&gt; 4.0f&#39;, 2)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pairs</span> <span class="o">=</span> <span class="n">_col_kind_width</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>
    <span class="n">form_width</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">c_kind</span><span class="p">,</span> <span class="n">c_width</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">c_kind</span> <span class="ow">in</span> <span class="n">INTS</span><span class="p">:</span>  <span class="c1"># ---- integer type</span>
            <span class="n">w_</span> <span class="o">=</span> <span class="s1">&#39;:&gt; </span><span class="si">{}</span><span class="s1">.0f&#39;</span>
            <span class="n">c_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_name</span><span class="p">),</span> <span class="n">c_width</span><span class="p">)</span> <span class="o">+</span> <span class="n">deci</span>
            <span class="n">c_format</span> <span class="o">=</span> <span class="n">w_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c_width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">c_kind</span> <span class="ow">in</span> <span class="n">FLOATS</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># ---- float rounded</span>
            <span class="n">w_</span> <span class="o">=</span> <span class="s1">&#39;:&gt; </span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">f&#39;</span>
            <span class="n">c_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_name</span><span class="p">),</span> <span class="n">c_width</span><span class="p">)</span> <span class="o">+</span> <span class="n">deci</span>
            <span class="n">c_format</span> <span class="o">=</span> <span class="n">w_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c_width</span><span class="p">,</span> <span class="n">deci</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_format</span> <span class="o">=</span> <span class="s2">&quot;!s:&lt;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c_width</span><span class="p">)</span>

        <span class="n">form_width</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c_format</span><span class="p">,</span> <span class="n">c_width</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">form_width</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (3) prn_nd .... code section</span>
<div class="viewcode-block" id="prn_nd"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.prn_nd">[docs]</a><span class="k">def</span> <span class="nf">prn_nd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;  .&quot;</span><span class="p">,</span> <span class="n">prnt</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format number arrays by row, and print</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    `a` : array</span>
<span class="sd">        An array of int or float dtypes, 1, 2, 3 and 4D arrays tested.</span>
<span class="sd">    `deci` - int</span>
<span class="sd">        Decimal places for floating point numbers</span>
<span class="sd">    `width` : int</span>
<span class="sd">        Default width for onscreen and printing, output beyond this</span>
<span class="sd">        length will be truncated with a warning.  Reshape to overcome.</span>
<span class="sd">    `title` : string</span>
<span class="sd">        The default title, change to provide more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Prints the array with the 1st dimension flattened-like by row</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - `w_frmt` :  width formatter</span>
<span class="sd">    - `m_frmt` :  max number formatter to get max. number of characters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_concat</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">r_fmt</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;print the subset to maximimum width&quot;&quot;&quot;</span>
        <span class="n">end</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;....&quot;</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">r_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">]</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="n">rw</span> <span class="o">=</span> <span class="p">[</span><span class="n">r_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">)[:</span><span class="n">width</span><span class="p">]</span> <span class="o">+</span> <span class="n">end</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">prefix</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rw</span><span class="p">)</span>  <span class="c1"># + &quot;\n&quot;</span>
        <span class="k">return</span> <span class="n">txt</span>

    <span class="k">def</span> <span class="nf">d4_frmt</span><span class="p">(</span><span class="n">a_shp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dealing with 4, 5 ?D arrays&quot;&quot;&quot;</span>
        <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a_shp</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">25</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">hdr</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span>
        <span class="k">if</span> <span class="n">a_dim</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">fm</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--(.., </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">txt</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d4</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="n">fm</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">a_s</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_s</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span>
            <span class="c1">#rows = [a_s[..., i, :, :].flatten() for i in range(r)]</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="n">_concat</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">row_frmt</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">d5_frmt</span><span class="p">(</span><span class="n">a_shp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dealing with 4, 5 ?D arrays&quot;&quot;&quot;</span>
        <span class="n">d5</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a_shp</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">25</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">hdr</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span>
        <span class="k">if</span> <span class="n">a_dim</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">fm</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--(.., </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">txt</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d5</span><span class="p">):</span>        
            <span class="n">t</span> <span class="o">+=</span> <span class="n">fm</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">a_s</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_s</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d4</span><span class="p">)]</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="n">_concat</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">row_frmt</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">d6_frmt</span><span class="p">(</span><span class="n">a_shp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dealing with 4, 5 ?D arrays&quot;&quot;&quot;</span>
        <span class="n">d6</span><span class="p">,</span> <span class="n">d5</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a_shp</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">25</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">hdr</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span>
        <span class="k">if</span> <span class="n">a_dim</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">fm</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--(.., </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">txt</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d6</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="n">fm</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">d5</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">a_s</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_s</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">)]</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="n">_concat</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">row_frmt</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>
    <span class="c1">#</span>
    <span class="c1"># ---- begin constructing the array format ----</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a_shp</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">,</span> <span class="n">a_kind</span><span class="p">,</span> <span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span> <span class="o">=</span> <span class="n">_check</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># get base array info</span>
    <span class="c1">#</span>
    <span class="c1"># ---- correct dtype, get formats ----</span>
    <span class="k">if</span> <span class="n">a_kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NUMS</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Only integer and float arrays with ndim &gt;= 2 supported&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">shape </span><span class="si">{}</span><span class="s2">, ndim </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_shp</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">)</span>
    <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a_shp</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
    <span class="n">row_frmt</span> <span class="o">=</span> <span class="n">_row_format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>
    <span class="n">row_frmt</span> <span class="o">=</span> <span class="p">(</span><span class="n">row_frmt</span> <span class="o">+</span> <span class="s2">&quot;  &quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">d3</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">txt</span>
    <span class="k">if</span> <span class="n">a_dim</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">d5</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a_shp</span>
<span class="c1">#        hdr = &quot;\n&quot; + &quot;-&quot;*25</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">d5_frmt</span><span class="p">(</span><span class="n">a_shp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="n">t</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
<span class="c1">#            for i in range(d4):</span>
<span class="c1">#                txt += hdr + &#39;\n--({}, ..&#39;.format(i)</span>
<span class="c1">#                t = d4_frmt(a_shp[1:], a[i], txt, a_dim)</span>
<span class="c1">#                txt = t</span>
    <span class="k">elif</span> <span class="n">a_dim</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">d6</span><span class="p">,</span> <span class="n">d5</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d3</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a_shp</span>
<span class="c1">#        hdr = &quot;\n&quot; + &quot;-&quot;*25</span>
<span class="c1">#        txt = &quot;&quot;</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">d6_frmt</span><span class="p">(</span><span class="n">a_shp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">a_dim</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="n">t</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span></div>
<span class="c1">#        for i in range(d5):</span>
<span class="c1">#            txt += hdr + &#39;\n--({}, ..&#39;.format(i)</span>
<span class="c1">#            t = d5_frmt(a_shp[1:], a[i], txt, a_dim)</span>
<span class="c1">#            txt += t</span>
<span class="c1">#                for i in range(d4):</span>
<span class="c1">##                    txt += str(i)</span>
<span class="c1">#                    txt += hdr + &#39;\n--({}, ..&#39;.format(i)</span>
<span class="c1">#                    t = d4_frmt(a_shp[2:], a[i], txt, a_dim)</span>
<span class="c1">#                    txt += t</span>
<span class="c1">#    with np.printoptions(precision=deci, linewidth=ln_wdth):</span>
<span class="c1">#        print(txt)</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (4) prn_ma .... code section</span>
<div class="viewcode-block" id="prn_ma"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.prn_ma">[docs]</a><span class="k">def</span> <span class="nf">prn_ma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;  .&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format a masked array to preserve columns widths and style.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    `a` : masked array</span>
<span class="sd">        A masked array</span>
<span class="sd">    `prn` : Boolean</span>
<span class="sd">        True to print</span>
<span class="sd">    `prefix` : text</span>
<span class="sd">        Can be &quot;&quot; for no indentation or &quot;   &quot; or the default</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Returns a print version of a masked array formatted with masked</span>
<span class="sd">    values and appropriate spacing.</span>
<span class="sd">    b = a.reshape(2,4,5) for 3d</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Get a string representation of the array.  Determine the maximum value</span>
<span class="sd">    length of a string of the values in the array  and format each column</span>
<span class="sd">    using that value.  Pad the result with a leader or replace the prefix</span>
<span class="sd">    with &#39;&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_fix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">prefix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; sub array adjust&quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;[[&#39;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;]]&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">tmp0</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="n">N0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N0</span><span class="p">):</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp0</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">frmt</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">tmp0</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">jn</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">prefix</span>
        <span class="n">v</span> <span class="o">+=</span> <span class="n">jn</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">out</span><span class="p">])</span>
        <span class="n">v</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">v</span>
    <span class="c1"># ---- main section ----</span>
<span class="c1">#    np.set_printoptions(edgeitems=edge, linewidth=width, precision=3,</span>
<span class="c1">#                    suppress=True, nanstr=&#39;-n-&#39;, threshold=1000)</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span>
    <span class="n">shp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>
    <span class="n">a_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">))),</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">a</span><span class="p">))))</span>  <span class="c1"># largest str</span>
    <span class="n">frmt</span> <span class="o">=</span> <span class="s1">&#39;{:&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">a_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;} &#39;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">:Masked array...</span><span class="se">\n</span><span class="s2">:shape: </span><span class="si">{}</span><span class="s2">  ndim: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">:.. a[:</span><span class="si">{}</span><span class="s2">, :</span><span class="si">{}</span><span class="s2">] ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">shp</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">_fix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">prefix</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">shp</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># dimension blocks</span>
            <span class="n">v</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">:.. a[</span><span class="si">{}</span><span class="s2">, :</span><span class="si">{}</span><span class="s2">, :</span><span class="si">{}</span><span class="s2">] ...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d0</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">d0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">_fix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">d0</span><span class="p">]),</span> <span class="n">prefix</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></div>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (5) pd and quick_prn</span>
<div class="viewcode-block" id="pd_"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.pd_">[docs]</a><span class="k">def</span> <span class="nf">pd_</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">use_names</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;see help for `prn_rec`...&quot;&quot;&quot;</span>
    <span class="n">prn_rec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">quick_prn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_lines</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format a structured array by setting the width so it hopefully wraps.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">width</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">edgeitems</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">max_lines</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                         <span class="n">precision</span><span class="o">=</span><span class="n">decimals</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nanstr</span><span class="o">=</span><span class="s1">&#39;-n-&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Array fields/values...:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">prn_q</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Quick print a structured array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rows : None or integer</span>
<span class="sd">        None, prints all the rows. If an integer, prints [:rows] of the array.</span>
<span class="sd">    deci : integer</span>
<span class="sd">        Number of decimal places to use for float values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cf</span> <span class="o">=</span> <span class="n">_col_format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>  <span class="c1"># ---- the big work done here</span>
    <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cf</span><span class="p">])</span>
    <span class="n">hdr</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{!s:&lt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cf</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hdr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">row</span><span class="p">]))</span>

    <span class="c1"># ----</span>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (6) prn_rec and prn_struct .... code section</span>
<span class="c1">#  both requires _c_kind_width, _col_format and subsample</span>

<div class="viewcode-block" id="prn_struct"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.prn_struct">[docs]</a><span class="k">def</span> <span class="nf">prn_struct</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">rows_m</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">cols_m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">prnt</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format a structured or recarray array.  See prn_rec for more details.</span>
<span class="sd">    This variant adds row and column slicing with the `width` and</span>
<span class="sd">    `max_lines` parameters.  Requires `subsample` and `_col_format`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">info</span> <span class="o">=</span> <span class="s2">&quot;Array... shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
    <span class="n">dtn</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cols_m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cols_m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
    <span class="n">rows_m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">rows_m</span><span class="p">)</span>
    <span class="c1"># ---- slice the rows</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_slice_rows</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge_rows</span><span class="o">=</span><span class="n">rows_m</span><span class="p">)</span>
    <span class="n">form_width</span> <span class="o">=</span> <span class="n">_col_format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>
    <span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">form_width</span><span class="p">]</span>
    <span class="n">wdths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">form_width</span><span class="p">]</span>
    <span class="n">tot_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">wdths</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tot_width</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">:</span>  <span class="c1"># ---- split wide arrays</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">wdths</span><span class="p">)</span>
        <span class="n">cols_m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cs</span> <span class="o">&lt;</span> <span class="n">width</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols_m</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_slice_head_tail</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cols_m</span><span class="p">)</span>
        <span class="n">dtn</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="n">form_width</span> <span class="o">=</span> <span class="n">_col_format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>  <span class="c1"># _col_format again</span>
        <span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">form_width</span><span class="p">]</span>
        <span class="n">wdths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">form_width</span><span class="p">]</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{&#39;</span><span class="o">+</span><span class="s2">&quot;!s:&lt;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">wdths</span><span class="p">])</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">dtn</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
    <span class="n">dtf</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dts</span><span class="p">])</span>  <span class="c1">#z[:, 0]])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># &lt;= rows_m:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">dtf</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head/tail rows: </span><span class="si">{}</span><span class="s2">, columns: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rows_m</span><span class="p">,</span> <span class="n">cols_m</span><span class="p">))</span></div>
    <span class="c1"># ---- done ----</span>


<div class="viewcode-block" id="prn_rec"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.prn_rec">[docs]</a><span class="k">def</span> <span class="nf">prn_rec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">rows_m</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">cols_m</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format a structured array with a mixed dtype</span>

<span class="sd">    Can be called as `pd_(a, ... )` to emulate pandas dataframes</span>
<span class="sd">    You should limit large arrays to a slice ie. a[:50]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : array</span>
<span class="sd">        A structured/recarray</span>
<span class="sd">    edges : integer</span>
<span class="sd">        Rows to keep from the start and end if max_rows is exceeded.</span>
<span class="sd">    deci : int</span>
<span class="sd">        To facilitate printing, this value is the number of decimal</span>
<span class="sd">        points to use for all floating point fields.</span>
<span class="sd">    max_rows : integer</span>
<span class="sd">        The number of rows to print before truncating to the `edges` option.</span>
<span class="sd">        Change this to a larger value should you need to print whole arrays.</span>
<span class="sd">    subsample : function</span>
<span class="sd">        Requires this fucction for sampling an array that exceeds max_rows.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `_col_format` does the actual work of obtaining a representation of</span>
<span class="sd">    the column format.</span>

<span class="sd">    It is not really possible to deconstruct the exact number of decimals</span>
<span class="sd">    to use for float values, so a decision had to be made to simplify.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
    <span class="k">if</span> <span class="n">cols_m</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cols_m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="c1"># slice off excess rows</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">rows_m</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">_slice_rows</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge_rows</span><span class="o">=</span><span class="n">rows_m</span><span class="p">)</span>
    <span class="c1"># ---- get the column formats from ... _col_format ----</span>
    <span class="n">form_width</span> <span class="o">=</span> <span class="n">_col_format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">)</span>
    <span class="n">dts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">form_width</span><span class="p">]</span>
    <span class="n">wdths</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">form_width</span><span class="p">]</span>
    <span class="c1"># slice off excess columns</span>
    <span class="n">c_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">wdths</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c_sum</span> <span class="o">&lt;</span> <span class="n">width</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">_slice_cols</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">edge_cols</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="c1"># slice the formats</span>
    <span class="n">tail</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
        <span class="n">tail</span> <span class="o">=</span> <span class="s1">&#39; ...&#39;</span>
    <span class="n">row_frmt</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([(</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dts</span><span class="p">[:</span><span class="n">N</span><span class="p">]])</span>
    <span class="n">hdr</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;!s:&lt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wdths</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">hdr2</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="n">hdr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot; id  &quot;</span> <span class="o">+</span> <span class="n">hdr2</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">names</span><span class="p">[:</span><span class="n">N</span><span class="p">])</span> <span class="o">+</span> <span class="n">tail</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>
    <span class="c1"># ---- assemble the print string ----</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="p">[</span><span class="n">header</span><span class="p">]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">txt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">{:&gt;03.0f}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="n">row_frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">tail</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">txt</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (7) prn_ ... code section .....</span>
<span class="c1">#  prn_ requires make_row_format</span>
<div class="viewcode-block" id="make_row_format"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.make_row_format">[docs]</a><span class="k">def</span> <span class="nf">make_row_format</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">a_kind</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">a_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">prnt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format the row based on input parameters</span>

<span class="sd">    `dim` - int</span>
<span class="sd">        Number of dimensions</span>
<span class="sd">    `cols` : int</span>
<span class="sd">        Columns per dimension</span>

<span class="sd">    `a_kind`, `deci`, `a_max` and `a_min` allow you to specify a data type,</span>
<span class="sd">    number of decimals and maximum and minimum values to test formatting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a_kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NUMS</span><span class="p">:</span>
        <span class="n">a_kind</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
    <span class="n">w_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;:</span><span class="si">{}</span><span class="s1">.0f&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:0.0f}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;:</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">f&#39;</span><span class="p">,</span> <span class="s1">&#39;{:0.</span><span class="si">{}</span><span class="s1">f}&#39;</span><span class="p">]][</span><span class="n">a_kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
    <span class="n">m_fmt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">deci</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">m_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_min</span><span class="p">,</span> <span class="n">deci</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">w_fmt</span> <span class="o">=</span> <span class="n">w_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m_fmt</span><span class="p">,</span> <span class="n">deci</span><span class="p">)</span>
    <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;  &#39;</span>
    <span class="k">while</span> <span class="n">m_fmt</span><span class="o">*</span><span class="n">cols</span><span class="o">*</span><span class="n">dim</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;.. &#39;</span>
    <span class="n">row_sub</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">w_fmt</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">cols</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="n">row_frmt</span> <span class="o">=</span> <span class="p">(</span><span class="n">row_sub</span><span class="o">*</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">prnt</span><span class="p">:</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;Row format: dim cols: (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)  kind: </span><span class="si">{}</span><span class="s2"> decimals: </span><span class="si">{}</span><span class="se">\n\n</span><span class="si">{}</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">dedent</span><span class="p">(</span><span class="n">frmt</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">a_kind</span><span class="p">,</span> <span class="n">deci</span><span class="p">,</span> <span class="n">row_frmt</span><span class="p">))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">*</span><span class="n">cols</span><span class="p">)</span>
        <span class="n">col_hdr</span><span class="p">(</span><span class="n">width</span><span class="o">//</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># run col_hdr to produce the column headers</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row_frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">row_frmt</span></div>


<div class="viewcode-block" id="prn_"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.prn_">[docs]</a><span class="k">def</span> <span class="nf">prn_</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;. . &quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Alternate format to prn_nd function.</span>
<span class="sd">    Inputs are largely the same.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_piece</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">frmt</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;piece together 3D chunks by row&quot;&quot;&quot;</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">sub</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s0</span><span class="p">)])</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fr</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">+</span> <span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="n">sub</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">=</span> <span class="n">frmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">line</span><span class="p">)[:</span><span class="n">linewidth</span><span class="p">]</span>
            <span class="n">end</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">linewidth</span><span class="p">]</span>
            <span class="n">txt</span> <span class="o">+=</span> <span class="n">indent</span><span class="p">(</span><span class="n">ln</span> <span class="o">+</span> <span class="n">end</span><span class="p">,</span> <span class="s2">&quot;. . &quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">txt</span>
    <span class="c1"># ---- main section ----</span>
    <span class="c1">#out = &quot;\n{}... ndim: {}  shape: {}\n&quot;.format(title, a.ndim, a.shape)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="n">width</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="c1"># ---- pull the 1st and 3rd dimension for 3D and 4D arrays</span>
    <span class="n">frmt</span> <span class="o">=</span> <span class="n">make_row_format</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                           <span class="n">cols</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                           <span class="n">a_kind</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span>
                           <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span>
                           <span class="n">a_max</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                           <span class="n">a_min</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                           <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                           <span class="n">prnt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="n">_piece</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">frmt</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>  <span class="c1"># ---- _piece ----</span>
    <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1">#s0):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">_piece</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">frmt</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>  <span class="c1"># ---- _piece</span>
    <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="n">frmt</span> <span class="o">*</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1">#s0):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">_piece</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">i</span><span class="p">,</span> <span class="n">frmt</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>        
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">width</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (8)  ---- form prn_3d4d ----</span>
<span class="k">def</span> <span class="nf">prn_3d4d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">edgeitems</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Another variant for formatting arrays geared towards 3d and 4d</span>
<span class="sd">    numeric and text arrays.  For object, structured arrays, see prn_rec</span>
<span class="sd">    in arraytools.frmts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_row_format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">deci</span><span class="p">,</span> <span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;abbreviated row format, see frmts.py in arraytools</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">NUMS</span><span class="p">:</span>
            <span class="n">w_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;:</span><span class="si">{}</span><span class="s1">.0f&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:0.0f}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;:</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">f&#39;</span><span class="p">,</span> <span class="s1">&#39;{:0.</span><span class="si">{}</span><span class="s1">f}&#39;</span><span class="p">]][</span><span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w_</span><span class="p">,</span> <span class="n">m_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;!s:&gt;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">]</span>
            <span class="n">deci</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_max</span><span class="p">,</span> <span class="n">deci</span><span class="p">)),</span> <span class="nb">len</span><span class="p">(</span><span class="n">m_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_min</span><span class="p">,</span> <span class="n">deci</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">w_fmt</span> <span class="o">=</span> <span class="n">w_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">deci</span><span class="p">)</span>
        <span class="n">r_fmt</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">w_fmt</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span>  <span class="c1"># d</span>
        <span class="k">return</span> <span class="n">r_fmt</span>
    <span class="c1">#</span>
    <span class="k">def</span> <span class="nf">head_tail</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Keep head and tail of array row/column indices [:e], [-e:]</span>
<span class="sd">        if s = 10 and e = 3, then</span>
<span class="sd">        h_t =&gt; array([ 0,  1,  2, -1,  5,  6,  7]) where -1 is a marker</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;</span> <span class="n">e</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">h_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">h_t</span><span class="p">[:</span><span class="n">e</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">h_t</span><span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">:]])</span>
        <span class="k">return</span> <span class="n">h_t</span>
    <span class="c1">#</span>
    <span class="c1"># (1) base information and reshape 3D to 4D array</span>
    <span class="n">ndim_in</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">s4</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">a_shp</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1">#</span>
    <span class="c1"># (2) split the indices keeping the row, column edgeitems</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">edgeitems</span>
    <span class="n">s3_</span> <span class="o">=</span> <span class="n">head_tail</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="n">s2_</span> <span class="o">=</span> <span class="n">head_tail</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># (3) assemble information for _row_format</span>
    <span class="n">d_</span><span class="p">,</span> <span class="n">r_</span><span class="p">,</span> <span class="n">c_</span> <span class="o">=</span> <span class="n">a_shp</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;&lt;^&gt;|bOUSV&#39;</span><span class="p">))</span> <span class="c1">#+ 1</span>
        <span class="n">a_min</span> <span class="o">=</span> <span class="n">a_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># cheat to get a number len of string</span>
    <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">):</span>
        <span class="n">a_min</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">a_max</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">fm0</span> <span class="o">=</span> <span class="n">_row_format</span><span class="p">(</span><span class="n">d_</span><span class="p">,</span> <span class="n">r_</span><span class="p">,</span> <span class="n">c_</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">deci</span><span class="p">,</span> <span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>  <span class="c1"># d=1</span>
    <span class="n">split_0</span> <span class="o">=</span> <span class="n">c_</span> <span class="o">&gt;</span> <span class="n">e</span><span class="o">*</span><span class="mi">2</span>  <span class="c1"># boolean check</span>
    <span class="k">if</span> <span class="n">split_0</span><span class="p">:</span>  <span class="c1"># e in place of c_</span>
        <span class="n">fm1</span> <span class="o">=</span> <span class="n">_row_format</span><span class="p">(</span><span class="n">d_</span><span class="p">,</span> <span class="n">r_</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span><span class="p">,</span> <span class="n">deci</span><span class="p">,</span> <span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># (4) process</span>
    <span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># &quot;Array... ndim {}  shape{}&quot;.format(a.ndim, a.shape)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s4</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ndim_in</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="s2">&quot; =&gt; (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> =&gt; (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">s2_</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s3_</span><span class="p">:</span>
                <span class="n">r_</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">split_0</span><span class="p">:</span>
                    <span class="n">sub</span> <span class="o">=</span> <span class="n">fm1</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">r_</span><span class="p">[:</span><span class="n">e</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; ..&quot;</span> <span class="o">+</span> <span class="n">fm1</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="n">e</span><span class="p">:])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sub</span> <span class="o">=</span> <span class="n">fm0</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">r_</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;{!s:^</span><span class="si">{}</span><span class="s2">}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot; ..&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="n">width</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
            <span class="n">t</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ..&quot;</span> <span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
    <span class="k">return</span> <span class="n">t</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (9)  ---- prn .... calls the other print methods</span>
<span class="c1">#</span>
<span class="c1"># decorator for prn ... testing </span>
<span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="si">{}{}{}</span><span class="s2"></span>
<span class="si">{}</span><span class="s2"> </span><span class="si">{}{}{}</span><span class="s2"></span>
<span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"></span>
<span class="si">{}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="k">def</span> <span class="nf">pr</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;print and array&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;wrapper function&quot;&quot;&quot;</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">shp</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">frmt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Array info...</span>
<span class="s2">        shape... </span><span class="si">{}</span><span class="s2">  ndim... </span><span class="si">{}</span><span class="s2">  dtype... </span><span class="si">{}</span><span class="s2"> </span>
<span class="s2">        </span><span class="si">{}{}{}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}{}{}</span><span class="s2"></span>
<span class="s2">        </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\u2554</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\u2550</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\u2551</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\u2554</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\u2550</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dim</span>  <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">s0</span> <span class="o">=</span> <span class="n">shp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">shp</span>
            <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">]</span>
            <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">s0</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
            <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">shp</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">shp</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">s4</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">shp</span>
        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span> <span class="o">=</span> <span class="n">shp</span>
        <span class="n">uni</span> <span class="o">=</span> <span class="p">[</span><span class="n">shp</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dim</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span>
               <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">s3</span><span class="p">,</span>
               <span class="n">s0</span><span class="p">,</span> <span class="n">s2</span><span class="p">]</span> <span class="c1"># &#39;\u2551&#39;, s2, s0</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">dedent</span><span class="p">(</span><span class="n">frmt</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">uni</span><span class="p">))</span>
<span class="c1">#        print(f.format(*uni))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1">#print(&quot;{!r:}\n&quot;.format(result))  # comment out if results not needed</span>
        <span class="k">return</span> <span class="n">result</span>                    <span class="c1"># for optional use outside.</span>
    <span class="k">return</span> <span class="n">wrapper</span>


<div class="viewcode-block" id="prn"><a class="viewcode-back" href="../../arraytools_mods.html#arraytools.frmts.prn">[docs]</a><span class="nd">@pr</span>
<span class="k">def</span> <span class="nf">prn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">120</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calling function for all the array print options.  Supports structured</span>
<span class="sd">    and ndarrays.  For multidimensional ndarrays, the first 3 dimensions are</span>
<span class="sd">    presented in a horizontal layout (see below).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rows : integer</span>
<span class="sd">        Limits the reported number of rows for large arrays</span>
<span class="sd">    cols : integer</span>
<span class="sd">        Equivalent to `edgeitems` in np.setprintoptions used to split and keep</span>
<span class="sd">        array corners for large arranys.</span>
<span class="sd">    deci : integer</span>
<span class="sd">        Reported number of decimal places for float values, it applies to all</span>
<span class="sd">        columns of that type.</span>
<span class="sd">    width : integer</span>
<span class="sd">        Maximum character limit before clipping occurs at the right edge.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This script calls other scripts depending on the input array dtype.  See</span>
<span class="sd">    the list below.</span>

<span class="sd">    The @pr decorator can be commented out from the source code if you prefer</span>
<span class="sd">    not to have the ancillary array shape information at the top of the output.</span>
<span class="sd">    ::</span>

<span class="sd">        Array info...</span>
<span class="sd">        shape... (2, 3, 4, 5)  ndim... 4  dtype... int32 </span>
<span class="sd">        ╔════3</span>
<span class="sd">        ║ ╔═5</span>
<span class="sd">        2 4</span>
<span class="sd">        </span>
<span class="sd">         =&gt; (0, 3, 4, 5)</span>
<span class="sd">         ..   0   1   2   3   4    20  21  22  23  24    40  41  42  43  44 </span>
<span class="sd">         ..   5   6   7   8   9    25  26  27  28  29    45  46  47  48  49 </span>
<span class="sd">         ..  10  11  12  13  14    30  31  32  33  34    50  51  52  53  54 </span>
<span class="sd">         ..  15  16  17  18  19    35  36  37  38  39    55  56  57  58  59 </span>
<span class="sd">         =&gt; (1, 3, 4, 5)</span>
<span class="sd">         ..  60  61  62  63  64    80  81  82  83  84   100 101 102 103 104 </span>
<span class="sd">         ..  65  66  67  68  69    85  86  87  88  89   105 106 107 108 109 </span>
<span class="sd">         ..  70  71  72  73  74    90  91  92  93  94   110 111 112 113 114 </span>
<span class="sd">         ..  75  76  77  78  79    95  96  97  98  99   115 116 117 118 119 </span>
<span class="sd">        Array shape (2, 3, 4, 5)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    `&lt;https://github.com/numpy/numpy/blob/</span>
<span class="sd">    f85c71a6d16ab64695f07fde23e2c19104d36208/numpy/core/numerictypes.py&gt;`_.</span>

<span class="sd">    Sample useage::</span>

<span class="sd">        prn_nd(a, deci=2, width=100, title=&quot;Array&quot;, prefix=&quot;  .&quot;, prnt=True)</span>
<span class="sd">        prn_(a, deci=2, width=100, title=&quot;Array&quot;, prefix=&quot;. . &quot;, prnt=True)</span>
<span class="sd">        prn_ma(a, deci=2, prnt=True, prefix=&quot;  .&quot;)</span>
<span class="sd">        prn_struct(a, rows_m=25, cols_m=None, deci=2, width=100, prnt=True)</span>
<span class="sd">        prn_rec(a, rows_m=25, cols_m=None, deci=2, width=100, prnt=True)</span>
<span class="sd">        prn_3d4d(a, deci=2, edgeitems=3, width=100, prnt=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">isMaskedArray</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>        <span class="c1"># ---- use this for masked arrays</span>
        <span class="n">prn_ma</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;  .&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">):</span>  <span class="c1"># ---- float-kind</span>
        <span class="k">if</span> <span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1">#prn_(a)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">ndim</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span>
        <span class="k">if</span> <span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">prn_3d4d</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span> <span class="n">edgeitems</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">+=</span> <span class="p">(</span><span class="s2">&quot;==&gt; </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">prn_3d4d</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span> <span class="n">edgeitems</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">indent</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Array shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">):</span>            <span class="c1"># ---- void, object arrays</span>
        <span class="c1">#prn_struct(a, rows_m=5, cols_m=None, deci=2, width=100)</span>
        <span class="n">prn_rec</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">rows_m</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols_m</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span></div>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># (8)  ---- sample data ----</span>

<span class="k">def</span> <span class="nf">_data</span><span class="p">(</span><span class="n">script</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;base file&quot;&quot;&quot;</span>
    <span class="n">pth</span> <span class="o">=</span> <span class="n">script</span> <span class="c1"># _data.__code__.co_filename</span>
    <span class="n">pth</span> <span class="o">=</span> <span class="n">pth</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;frmts.py&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pth</span> <span class="o">+</span> <span class="s2">&quot;Data/points_2000.npy&quot;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pth</span> <span class="o">+</span> <span class="s2">&quot;Data/sample_20.npy&quot;</span><span class="p">)</span>
    <span class="n">c_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pth</span> <span class="o">+</span> <span class="s2">&quot;Data/masked_data.npy&quot;</span><span class="p">)</span>
    <span class="n">c_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pth</span> <span class="o">+</span> <span class="s2">&quot;Data/masked_mask.npy&quot;</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">c_m</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pth</span> <span class="o">+</span> <span class="s2">&quot;Data/ndim4.npy&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>


<span class="c1"># -------------------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># print the script source name.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Script... </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Dan Patterson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>